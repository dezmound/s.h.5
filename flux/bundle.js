!function(e){var t={};function s(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,s),r.l=!0,r.exports}s.m=e,s.c=t,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},s.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=19)}([function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=s(4),r=s(3);t.default=class extends n.Message{constructor(e,t){super(e,t),r.default.Instance.log(`Сформировано сообщение: ${this.Type}`)}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s(14);t.Store=n.default;var r=s(6);t.View=r.default;var i=s(8);t.Dispatcher=i.default;var a=s(0);t.FluxMessage=a.default,function(e){e.GET_VIEW_STORE="getViewStore",e.CHANGE_DISPATCHER_STORE="changeValueDispatcherStore",e.UPDATE_STORE_VIEW="updateStoreView",e.UPDATE_VIEW_DISPATCHER="updateViewDispatcher"}(t.FluxMessageType||(t.FluxMessageType={}));t.FluxError=class extends Error{constructor(e){super(`Flux error: ${e}`)}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=s(4);t.default=class extends n.Observable{getNotification(e){return!!this.checkMessage(e)&&e.handle(this)}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=s(4);class r extends n.Observable{constructor(){super(),this.messages=[]}static get Instance(){return this.instance||(this.instance=new r),this.instance}log(e){this.messages.push(e),console.log(e+" --\x3e 🙀"),this.notify(new n.CustomMessage("",""))}get(){return this.messages}flush(){const e=this.messages;return this.messages=[],e}}t.default=r},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s(12);t.Message=n.default;var r=s(16);t.Observable=r.Observable;var i=s(15);t.CustomMessage=i.default},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class n{static contentsBetween(e,t){let s=e;const n=new Set,[r,i]=t.split("|");let a=s.indexOf(r),c=s.indexOf(i);for(;a>=0&&c>=0;)n.add(s.substr(a+r.length,c-a-r.length)),a=(s=s.substr(c+i.length)).indexOf(r),c=s.indexOf(i);return Array.from(n)}static sameObjects(e,t){let s=!0;const[r,i]=[Object.entries(e),Object.entries(t)];return r.length===i.length&&(r.some(([e,r])=>t.hasOwnProperty(e)&&Object.is(r,t[e])?r instanceof Object&&t[e]instanceof Object&&!n.sameObjects(r,t[e])?!(s=!1):void 0:!(s=!1)),s)}static includes(e,t,s=Object.is){return e.filter(e=>s(e,t)).length>0}static getValue(e){e=Object.assign({delimiter:".",saveStruct:!0},e);const{obj:t,delimiter:s,saveStruct:r}=e;let{path:i}=e,a=t;const c={};return i instanceof Object&&(i=n.getObjectSchema(i).pop()),i.split(s).forEach(e=>{(a=a[e])instanceof Object&&(c[e]={}),c[e]=a}),r?c:a}static getObjectSchema(e,t="."){return Object.keys(e).map(s=>e[s]instanceof Object&&!(e[s]instanceof Array)?[s,...n.getObjectSchema(e[s])].join(t):s)}static intersection(...e){const t=[],s=n.getIntersectionedSchema(e,t);return Object.assign({},...s.map(e=>t.filter(t=>t.schema.includes(e)).map(t=>n.getValue({obj:t.obj,path:e}))).reduce((e,t)=>e instanceof Object&&t instanceof Object?[e,t]:e.concat(t)))}static getIntersectionedSchema(e,t){let s=[];return e.forEach(e=>{const r=n.getObjectSchema(e);t.push({schema:r,obj:e}),s=0===s.length?r:s.filter(e=>r.includes(e))}),s}}t.default=n},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const utils_1=__webpack_require__(5),FluxMessageStoreViewUpdate_1=__webpack_require__(11),FluxMessageViewDispatcherUpdate_1=__webpack_require__(7),FluxMessageViewStoreGet_1=__webpack_require__(10),FluxMessageHandler_1=__webpack_require__(2),ServerStoreDispatcher_1=__webpack_require__(9),Store_1=__webpack_require__(14);class View extends FluxMessageHandler_1.default{constructor(e,t){super(),this.dependencies=[],this.innerViews=[],this.tag=e,this.dom=document.createElement(this.tag),this.dom.setAttribute("view",""),this.dom.view=this,Store_1.default.Instance.subscribe(this),this.subscribe(Store_1.default.Instance),this.subscribe(ServerStoreDispatcher_1.default.Instance),this.template=t||document.querySelector(this.tag).innerHTML,this.innerViews=View.getInnerViews(this)}static getInnerViews(e){return Array.from(e.Dom.querySelectorAll("[view]")).map(e=>new View(e.tagName.toLowerCase(),e.innerHTML))||[]}get Dom(){return this.dom.innerHTML||(this.dom.innerHTML=this.template),this.dom}get Tag(){return this.tag}get Dependencies(){return this.dependencies}get(e){this.addDependency(e);const[t]=this.notify(new FluxMessageViewStoreGet_1.default(e));return utils_1.default.getValue({obj:t,path:e,saveStruct:!1})}update(e){return this.notify(new FluxMessageViewDispatcherUpdate_1.default(e))}render(){return this.innerViews.forEach(e=>{const t=e.render();this.dom.appendChild(t),this.Dom.replaceChild(t,this.Dom.querySelector(e.Tag))}),this.renderTemplate()}checkMessage(e){return e instanceof FluxMessageStoreViewUpdate_1.default}addDependency(e){const t=utils_1.default.getObjectSchema(e).pop();this.dependencies.includes(t)||(this.dependencies.push(t),this.notify(new FluxMessageViewDispatcherUpdate_1.default(e)))}escapeTemplate(){utils_1.default.contentsBetween(this.template,"${|}$").forEach(code=>{const element=document.createElement("textarea");element.innerHTML=code;const escaped=element.value;this.template=this.template.replace(`\${${code}}$`,eval(escaped))})}renderTemplate(){if(0===this.innerViews.length){const e=this.template;this.escapeTemplate(),this.dom.innerHTML=this.template,this.template=e}return this.dom}}exports.default=View},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=s(1),r=s(0),i=s(13);t.default=class extends r.default{constructor(e){super(n.FluxMessageType.UPDATE_VIEW_DISPATCHER,e)}handle(e){return e.notify(new i.FluxMessageDispatcherStoreChange(this.Data))}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=s(7),r=s(2);class i extends r.default{constructor(){super()}static get Instance(){return this.instance||(this.instance=new i),this.instance}checkMessage(e){return e instanceof n.default}}t.default=i},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=s(3),r=s(8);class i extends r.default{static get Instance(){return this.instance||(this.instance=new i),this.instance}getNotification(e){const t=super.getNotification(e);return t&&n.default.Instance.log(`Сервер принял данные: ${JSON.stringify(e.Data)}`),t}}i.instance=null,t.default=i},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=s(1),r=s(0);t.default=class extends r.default{constructor(e){super(n.FluxMessageType.GET_VIEW_STORE,e)}handle(e){return e.get(this.Data)}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=s(1),r=s(5),i=s(0);t.default=class extends i.default{constructor(e){super(n.FluxMessageType.UPDATE_STORE_VIEW,e)}handle(e){const t=r.default.getObjectSchema(this.Data).pop();e.Dependencies.includes(t)&&e.render()}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(e,t){this.type=e,this.data=t}get Type(){return this.type}get Data(){return this.data}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=s(1),r=s(0);t.FluxMessageDispatcherStoreChange=class extends r.default{constructor(e){super(n.FluxMessageType.CHANGE_DISPATCHER_STORE,e)}handle(e){return e.update(this.Data)}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=s(5),r=s(13),i=s(11),a=s(10),c=s(2),u=s(9);class o extends c.default{constructor(){super()}static get Instance(){return this.instance||(this.instance=new this,u.default.Instance.subscribe(this.instance)),this.instance}get State(){return Object.assign({},o.state)}registerInDispatcher(e){this.dispatcher||(this.dispatcher=e,this.dispatcher.subscribe(this))}get(e){return n.default.intersection(e,o.Instance.State)}update(e){return o.state=Object.assign(o.state,e),this.notify(new i.default(e)),e}checkMessage(e){return e instanceof r.FluxMessageDispatcherStoreChange||e instanceof a.default}}o.state={},t.default=o},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=s(12);t.default=class extends n.default{}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Observable=class{constructor(){this.subscribers=[]}subscribe(e){this.subscribers.push(e)}unsubscribe(e){this.subscribers=this.subscribers.filter(t=>t!==e)}notify(e){return this.subscribers.map(t=>t.getNotification(e))}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=s(1),r=s(3);t.default=class{get Logger(){return r.default.Instance}constructor(e="app",t="template"){this.root=new n.View(e,document.querySelector(t).innerHTML),this.rootElement=t}init(){const e=this.root.render(),t=document.querySelector(this.rootElement);t.parentNode.appendChild(e),t.parentNode.replaceChild(e,t),this.monkeyPathing()}monkeyPathing(){window.view=(e=>{let t=e.parentElement;for(;t&&null===t.getAttribute("view");)t=t.parentElement;if(!t)throw new n.FluxError("Cannot find parent view of current element.");return t.view})}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s(17);t.App=n.default;var r=s(6);t.View=r.default},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=new(s(18).App);window.Logger=n.Logger,n.init();const r=document.querySelector("view-logger").view;n.Logger.subscribe({getNotification(){r.render()}})}]);